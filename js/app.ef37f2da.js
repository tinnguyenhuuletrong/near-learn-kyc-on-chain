(function(t){function e(e){for(var r,c,i=e[0],s=e[1],l=e[2],d=0,p=[];d<i.length;d++)c=i[d],Object.prototype.hasOwnProperty.call(o,c)&&o[c]&&p.push(o[c][0]),o[c]=0;for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(t[r]=s[r]);u&&u(e);while(p.length)p.shift()();return a.push.apply(a,l||[]),n()}function n(){for(var t,e=0;e<a.length;e++){for(var n=a[e],r=!0,i=1;i<n.length;i++){var s=n[i];0!==o[s]&&(r=!1)}r&&(a.splice(e--,1),t=c(c.s=n[0]))}return t}var r={},o={app:0},a=[];function c(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.m=t,c.c=r,c.d=function(t,e,n){c.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},c.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},c.t=function(t,e){if(1&e&&(t=c(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)c.d(n,r,function(e){return t[e]}.bind(null,r));return n},c.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return c.d(e,"a",e),e},c.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},c.p="/near-learn-kyc-on-chain/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],s=i.push.bind(i);i.push=e,i=i.slice();for(var l=0;l<i.length;l++)e(i[l]);var u=s;a.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"0104":function(t,e,n){},1:function(t,e){},2:function(t,e){},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("2b0e"),o=n("67b0"),a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"root"}},[n("SignedOut",{directives:[{name:"show",rawName:"v-show",value:!t.isSignedIn,expression:"!isSignedIn"}]}),n("SignedIn",{directives:[{name:"show",rawName:"v-show",value:t.isSignedIn,expression:"isSignedIn"}]})],1)},c=[],i=(n("99af"),n("0104"),n("db49")),s=n.n(i),l=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("main",[n("h1",[t._v("Welcome to NEAR!")]),n("p",[t._v(" To make use of the NEAR blockchain, you need to sign in. The button below will sign you in using NEAR Wallet. ")]),n("p",[t._v(' By default, when your app runs in "development" mode, it connects to a test network ("testnet") wallet. This works just like the main network ("mainnet") wallet, but the NEAR Tokens on testnet aren\'t convertible to other currencies - they\'re just for testing! ')]),n("p",[t._v("Go ahead and click the button below to try it out:")]),n("p",{staticStyle:{"text-align":"center","margin-top":"2.5em"}},[n("button",{on:{click:t.login}},[t._v("Sign in")])])])},u=[],d=n("1da1"),p=(n("96cf"),n("ac1f"),n("5319"),n("d9eb")),w=s()(Object({NODE_ENV:"production",VUE_APP_CONTRACT_NAME:"dev-1631519031086-9364402",BASE_URL:"/near-learn-kyc-on-chain/"}).NEAR_ENV||"development");function f(){return g.apply(this,arguments)}function g(){return g=Object(d["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(p["connect"])(Object.assign({deps:{keyStore:new p["keyStores"].BrowserLocalStorageKeyStore}},w));case 2:return e=t.sent,window.walletConnection=new p["WalletConnection"](e),window.accountId=window.walletConnection.getAccountId(),t.next=7,new p["Contract"](window.walletConnection.account(),w.contractName,{viewMethods:["info","hasCandidate","getKycStatus"],changeMethods:["addCandidate"]});case 7:window.contract=t.sent;case 8:case"end":return t.stop()}}),t)}))),g.apply(this,arguments)}function h(){window.walletConnection.signOut(),window.location.replace(window.location.origin+window.location.pathname)}function v(){window.walletConnection.requestSignIn(w.contractName)}console.log(w);var m={name:"SignedOut",methods:{login:function(){console.log("calling utils.login"),v()}}},b=m,k=n("2877"),I=Object(k["a"])(b,l,u,!1,null,null,null),_=I.exports,y=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("button",{staticClass:"link",staticStyle:{float:"right"},on:{click:t.logout}},[t._v(" Sign out ")]),n("main",[t.bizName?n("h1",[t._v(" BizName: "),n("label",{staticStyle:{color:"var(--secondary)","border-bottom":"2px solid var(--secondary)"},attrs:{for:"greeting"}},[t._v(t._s(t.bizName))])]):t._e(),n("h5",[t._v(" Near Acc: "),n("label",[t._v(t._s(t.accountId))])]),t.shouldShowKycButton?n("div",{staticClass:"register-container"},[n("VueLoadingButton",{attrs:{loading:t.isLoading},nativeOn:{click:function(e){return t.startKyc.apply(null,arguments)}}},[t._v("Start KYC")]),n("div",{attrs:{id:"blockpass-kyc-connect"}})],1):t._e(),t.isApproved?n("div",[n("h2",[t._v(" Congratulation your KYC check completed ")]),n("h6",[t._v(" * unlock some action ")])]):t._e()]),n("Notification",{directives:[{name:"show",rawName:"v-show",value:t.notificationVisible,expression:"notificationVisible"}],ref:"notification",attrs:{networkId:t.networkId,msg:"called method: setGreeting",contractId:t.contractId,visible:!1}})],1)},S=[],x=(n("caad"),n("0a4b")),N=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"notification"},[n("aside",[n("a",{attrs:{target:"_blank",rel:"noreferrer",href:t.urlPrefix+"/"+t.accountId}},[t._v(t._s(t.accountId))]),n("br"),t._v(" "+t._s(t.msg)+" "),n("br"),t._v("in contract: "),n("a",{attrs:{target:"_blank",rel:"noreferrer",href:t.urlPrefix+"/"+t.contractId}},[t._v(t._s(t.contractId))]),t._m(0)])])},C=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("footer",[n("div",[t._v("âœ” Succeeded")]),n("div",[t._v("Just now")])])}],O={name:"Notification",props:{networkId:String,msg:String,contractId:String},computed:{urlPrefix:function(){return"https://explorer."+this.networkId+".near.org/accounts"},accountId:function(){return window.accountId}}},E=O,j=Object(k["a"])(E,N,C,!1,null,null,null),A=j.exports,U={name:"SignedIn",beforeMount:function(){this.isSignedIn&&this.retrieveInfo()},components:{VueLoadingButton:x["a"],Notification:A},data:function(){return{kycStatus:"",savedGreeting:"",newGreeting:"",notificationVisible:!1,bizName:"",clientId:"",scHasCandidate:!1,scRefId:"",isLoading:!1}},computed:{isSignedIn:function(){return!!window.walletConnection&&window.walletConnection.isSignedIn()},accountId:function(){return window.accountId},contractId:function(){return window.contract?window.contract.contractId:null},networkId:function(){return window.networkId},shouldShowKycButton:function(){return["not_found","waiting"].includes(this.kycStatus)},isApproved:function(){return["approved"].includes(this.kycStatus)}},methods:{retrieveInfo:function(){var t=this;return Object(d["a"])(regeneratorRuntime.mark((function e(){var n,r,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,window.contract.info();case 2:return n=e.sent,console.log(n),t.bizName=n.bizName,t.clientId=n.bizBlockpassClientId,e.next=8,window.contract.hasCandidate({accId:t.accountId});case 8:if(r=e.sent,t.scHasCandidate=r,r){e.next=14;break}t.kycStatus="not_found",e.next=26;break;case 14:return e.next=16,window.contract.getKycStatus({accId:t.accountId});case 16:o=e.sent,console.log(o),e.t0=o.status,e.next=0===e.t0?21:1===e.t0?23:25;break;case 21:return t.kycStatus="waiting",e.abrupt("break",25);case 23:return t.kycStatus="approved",e.abrupt("break",25);case 25:t.scRefId=o.refId;case 26:case"end":return e.stop()}}),e)})))()},startKyc:function(){var t=this;return Object(d["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.isLoading=!0,e.prev=1,t.scHasCandidate){e.next=8;break}return e.next=5,window.contract.addCandidate({accountId:t.accountId});case 5:n=e.sent,console.log(n),t.scRefId=n;case 8:e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](1),alert(e.t0.message);case 13:t.isLoading=!1,t._startWidget(t.scRefId);case 15:case"end":return e.stop()}}),e,null,[[1,10]])})))()},_startWidget:function(t){console.log(t);var e=document.getElementById("blockpass-kyc-connect"),n=e.cloneNode(!0);e.parentNode.replaceChild(n,e);var r=new BlockpassKYCConnect(this.clientId,{local_user_id:t});r.startKYCConnect();var o=document.getElementById("blockpass-kyc-connect");o&&o.click&&o.click()},logout:h}},R=U,P=(n("d815"),Object(k["a"])(R,y,S,!1,null,null,null)),B=P.exports,T=s()("production");console.log("networkId:".concat(T.networkId," CONTRACT_NAME:").concat(T.contractName)),window.networkId=T.networkId;var K={created:function(){document.title="blockpass-kyc-onchain"},name:"App",components:{SignedOut:_,SignedIn:B},computed:{isSignedIn:function(){return window.walletConnection.isSignedIn()}}},M=K,V=Object(k["a"])(M,a,c,!1,null,null,null),L=V.exports;r["a"].use(o["a"]),r["a"].config.productionTip=!1,r["a"].loadScript("https://cdn.blockpass.org/widget/scripts/release/3.0.2/blockpass-kyc-connect.prod.js"),window.nearInitPromise=f().then((function(){new r["a"]({render:function(t){return t(L)}}).$mount("#app")}))},"8de6":function(t,e,n){},d815:function(t,e,n){"use strict";n("8de6")},db49:function(t,e,n){var r="dev-1631519031086-9364402";function o(t){switch(t){case"production":case"mainnet":return{networkId:"mainnet",nodeUrl:"https://rpc.mainnet.near.org",contractName:r,walletUrl:"https://wallet.near.org",helperUrl:"https://helper.mainnet.near.org",explorerUrl:"https://explorer.mainnet.near.org"};case"development":case"testnet":return{networkId:"testnet",nodeUrl:"https://rpc.testnet.near.org",contractName:r,walletUrl:"https://wallet.testnet.near.org",helperUrl:"https://helper.testnet.near.org",explorerUrl:"https://explorer.testnet.near.org"};case"betanet":return{networkId:"betanet",nodeUrl:"https://rpc.betanet.near.org",contractName:r,walletUrl:"https://wallet.betanet.near.org",helperUrl:"https://helper.betanet.near.org",explorerUrl:"https://explorer.betanet.near.org"};case"local":return{networkId:"local",nodeUrl:"http://localhost:3030",keyPath:"".concat(Object({NODE_ENV:"production",VUE_APP_CONTRACT_NAME:"dev-1631519031086-9364402",BASE_URL:"/near-learn-kyc-on-chain/"}).HOME,"/.near/validator_key.json"),walletUrl:"http://localhost:4000/wallet",contractName:r};case"test":case"ci":return{networkId:"shared-test",nodeUrl:"https://rpc.ci-testnet.near.org",contractName:r,masterAccount:"test.near"};case"ci-betanet":return{networkId:"shared-test-staging",nodeUrl:"https://rpc.ci-betanet.near.org",contractName:r,masterAccount:"test.near"};default:throw Error("Unconfigured environment '".concat(t,"'. Can be configured in src/config.js."))}}t.exports=o}});
//# sourceMappingURL=app.ef37f2da.js.map